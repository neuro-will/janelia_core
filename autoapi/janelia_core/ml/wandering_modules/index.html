<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>janelia_core.ml.wandering_modules &mdash; janelia_core 1.0 documentation</title><link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="janelia_core.registration" href="../../registration/index.html" />
    <link rel="prev" title="janelia_core.ml.utils" href="../utils/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> janelia_core
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../install.html">Setting up the core library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../install.html#dependencies">Dependencies</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">janelia_core</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../cell_extraction/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.cell_extraction</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dataprocessing/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.dataprocessing</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../fileio/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.fileio</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../math/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.math</span></code></a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.ml</span></code></a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../index.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../registration/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.registration</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stats/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.stats</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.utils</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../visualization/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.visualization</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">janelia_core</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core</span></code></a> &raquo;</li>
          <li><a href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.ml</span></code></a> &raquo;</li>
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.ml.wandering_modules</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/autoapi/janelia_core/ml/wandering_modules/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-janelia_core.ml.wandering_modules">
<span id="janelia-core-ml-wandering-modules"></span><h1><a class="reference internal" href="#module-janelia_core.ml.wandering_modules" title="janelia_core.ml.wandering_modules"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.ml.wandering_modules</span></code></a><a class="headerlink" href="#module-janelia_core.ml.wandering_modules" title="Permalink to this headline"></a></h1>
<p>Contains an experimental set of modules with parameters that can display some drift during fitting.</p>
<p>Wandering modules are Torch modules which allow for modifications of their parameters and the gradients
for their parameters during gradient fitting routines. They are called wandering because in many cases,
small amounts of noise can be added to the the gradients, so these parameters display a random walk when
gradients are zero.</p>
<div class="section" id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this headline"></a></h2>
<div class="section" id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline"></a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#janelia_core.ml.wandering_modules.WanderingModule" title="janelia_core.ml.wandering_modules.WanderingModule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WanderingModule</span></code></a></p></td>
<td><p>Base class for wandering modules.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#janelia_core.ml.wandering_modules.BumpFcn" title="janelia_core.ml.wandering_modules.BumpFcn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BumpFcn</span></code></a></p></td>
<td><p>A function representing a single exponential bump.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#janelia_core.ml.wandering_modules.SumOfBumpFcns" title="janelia_core.ml.wandering_modules.SumOfBumpFcns"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SumOfBumpFcns</span></code></a></p></td>
<td><p>A sum of bump functions, each with learnable centers, widths and magnitudes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#janelia_core.ml.wandering_modules.SlowSumOfBumpFcns" title="janelia_core.ml.wandering_modules.SlowSumOfBumpFcns"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SlowSumOfBumpFcns</span></code></a></p></td>
<td><p>Implements a sum of bump functions which will be slower in computation on GPU, but may be have memory benefits.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="janelia_core.ml.wandering_modules.WanderingModule">
<em class="property">class </em><code class="sig-prename descclassname">janelia_core.ml.wandering_modules.</code><code class="sig-name descname">WanderingModule</code><a class="reference internal" href="../../../../_modules/janelia_core/ml/wandering_modules.html#WanderingModule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.ml.wandering_modules.WanderingModule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">abc.ABC</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
<p>Base class for wandering modules.</p>
<p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="py method">
<dt id="janelia_core.ml.wandering_modules.WanderingModule.bound">
<em class="property">abstract </em><code class="sig-name descname">bound</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/janelia_core/ml/wandering_modules.html#WanderingModule.bound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.ml.wandering_modules.WanderingModule.bound" title="Permalink to this definition"></a></dt>
<dd><p>Bounds parameters in the module.</p>
<p>This method takes no arguments, other than self, as the bounds themselves are expected to be saved as attributes
of the module.</p>
</dd></dl>

<dl class="py method">
<dt id="janelia_core.ml.wandering_modules.WanderingModule.pert_grads">
<em class="property">abstract </em><code class="sig-name descname">pert_grads</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/janelia_core/ml/wandering_modules.html#WanderingModule.pert_grads"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.ml.wandering_modules.WanderingModule.pert_grads" title="Permalink to this definition"></a></dt>
<dd><p>Perturbs (or adjusts) gradients of parameters of the module.</p>
<p>This method takes no arguments, other than self, as any customization of how gradients are perturbed should
be controlled through adjusting attributes of the module.  For example, the amount of noise added to gradients
could be determined by an attribute.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="janelia_core.ml.wandering_modules.BumpFcn">
<em class="property">class </em><code class="sig-prename descclassname">janelia_core.ml.wandering_modules.</code><code class="sig-name descname">BumpFcn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">c</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">w</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">m</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">c_bounds</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w_bounds</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">c_grad_std</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">w_grad_std</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">m_grad_gain</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">support_p</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/janelia_core/ml/wandering_modules.html#BumpFcn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.ml.wandering_modules.BumpFcn" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#janelia_core.ml.wandering_modules.WanderingModule" title="janelia_core.ml.wandering_modules.WanderingModule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WanderingModule</span></code></a></p>
<p>A function representing a single exponential bump.
The bump function is of the form:</p>
<blockquote>
<div><p>y = m*exp(-sum(((x - c)/w)**2)),</p>
</div></blockquote>
<p>where x is input, c is the center of the bump, w determines the width of the bump and mm determines the magnitude of
the bump. Note that x can be multi-dimensional, in which case c and w are vectors of the appropriate dimension.</p>
<p>Creates a new BumpFcn module.</p>
<dl>
<dt>Args:</dt><dd><p>c: The initial center</p>
<p>w: The initial weight</p>
<p>m: The initial magnitude</p>
<p>c_bounds: Bounds for the center parameter.  First row is lower bounds; second row is upper bounds. If
None, the center will not be bounded.</p>
<p>w_bounds: Bounds for the width parameter.  First row is lower bounds; second row is upper bounds. If
None, the width parameters will not be bounded.</p>
<p>c_grad_std: The standard deviation to use when perturbing gradients for the center parameters with random
noise</p>
<p>w_grad_std: The standard deviation to use when perturbing gradients for the width parameters with random
noise</p>
<p>m_grad_gain: The gain to use when perturbing the gradient for the magnitude.  The gradient is perturbed by
subtracting the value m*grad_gain from the gradient for m.</p>
<p>support_p: The percent of max value in any direction where we define the boundary of support.  This is
used for skipping function evaluation for input values that are outside of the support.</p>
</dd>
</dl>
<dl class="py method">
<dt id="janelia_core.ml.wandering_modules.BumpFcn.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">small_output</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../../../../_modules/janelia_core/ml/wandering_modules.html#BumpFcn.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.ml.wandering_modules.BumpFcn.forward" title="Permalink to this definition"></a></dt>
<dd><p>Computes output from input.</p>
<dl>
<dt>Args:</dt><dd><p>x: Input of shape n_smps*d_in</p>
<p>small_output: If false, then output is a tensor of length n_smps, where y[i] is the output for x[i,:]. If
true, output is a tuple.  The first entry in the tuple is a tuple of indices of points where output is
non-zero and the second is a tuple of values for these points.</p>
</dd>
</dl>
<p>Returns:</p>
<blockquote>
<div><p>y: Output of shame n_smps</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="janelia_core.ml.wandering_modules.BumpFcn.bound">
<code class="sig-name descname">bound</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/janelia_core/ml/wandering_modules.html#BumpFcn.bound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.ml.wandering_modules.BumpFcn.bound" title="Permalink to this definition"></a></dt>
<dd><p>Bounds parameters of the module.</p>
</dd></dl>

<dl class="py method">
<dt id="janelia_core.ml.wandering_modules.BumpFcn.pert_grads">
<code class="sig-name descname">pert_grads</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/janelia_core/ml/wandering_modules.html#BumpFcn.pert_grads"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.ml.wandering_modules.BumpFcn.pert_grads" title="Permalink to this definition"></a></dt>
<dd><p>Perturbs gradients.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="janelia_core.ml.wandering_modules.SumOfBumpFcns">
<em class="property">class </em><code class="sig-prename descclassname">janelia_core.ml.wandering_modules.</code><code class="sig-name descname">SumOfBumpFcns</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">c</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">w</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">m</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">c_bounds</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">w_bounds</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/janelia_core/ml/wandering_modules.html#SumOfBumpFcns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.ml.wandering_modules.SumOfBumpFcns" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#janelia_core.ml.wandering_modules.WanderingModule" title="janelia_core.ml.wandering_modules.WanderingModule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WanderingModule</span></code></a></p>
<p>A sum of bump functions, each with learnable centers, widths and magnitudes.</p>
<p>(See BumpFcn for the functional form of a single bump function).</p>
<p>Creates a new SumOfBumpFcns modules.</p>
<p>Currently this module allows for bounding of centers and widths, but does not perturb gradients (which is to say
the pert_grads() method does nothing).</p>
<dl>
<dt>Args:</dt><dd><p>c: Initial centers.  Each column is a center for a bump.</p>
<p>w: Initial widths.  Each column is the width parameters for a bump.</p>
<p>m: Initial magnitudes.  Each entry is the magnitude for a bump.</p>
<p>c_bounds: Bounds for the center parameter.  First column is lower bounds; second column is upper bounds. If
None, the center will not be bounded.</p>
<p>w_bounds: Bounds for the width parameter.  First column is lower bounds; second column is upper bounds. If
None, the width parameters will not be bounded.</p>
</dd>
</dl>
<dl class="py method">
<dt id="janelia_core.ml.wandering_modules.SumOfBumpFcns.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../../../../_modules/janelia_core/ml/wandering_modules.html#SumOfBumpFcns.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.ml.wandering_modules.SumOfBumpFcns.forward" title="Permalink to this definition"></a></dt>
<dd><p>Computes input from output.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>x: Input of shape n_smps*n_dims</p>
</dd>
<dt>Returns:</dt><dd><p>y: Output of length n_smps</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="janelia_core.ml.wandering_modules.SumOfBumpFcns.bound">
<code class="sig-name descname">bound</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/janelia_core/ml/wandering_modules.html#SumOfBumpFcns.bound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.ml.wandering_modules.SumOfBumpFcns.bound" title="Permalink to this definition"></a></dt>
<dd><p>Bounds parameters in the module.</p>
<p>This method takes no arguments, other than self, as the bounds themselves are expected to be saved as attributes
of the module.</p>
</dd></dl>

<dl class="py method">
<dt id="janelia_core.ml.wandering_modules.SumOfBumpFcns.pert_grads">
<code class="sig-name descname">pert_grads</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/janelia_core/ml/wandering_modules.html#SumOfBumpFcns.pert_grads"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.ml.wandering_modules.SumOfBumpFcns.pert_grads" title="Permalink to this definition"></a></dt>
<dd><p>Currently we don’t implement any gradient perturbations.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="janelia_core.ml.wandering_modules.SlowSumOfBumpFcns">
<em class="property">class </em><code class="sig-prename descclassname">janelia_core.ml.wandering_modules.</code><code class="sig-name descname">SlowSumOfBumpFcns</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">c</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">w</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">m</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">c_bounds</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">w_bounds</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">c_grad_std</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">w_grad_std</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">m_grad_gain</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">support_p</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/janelia_core/ml/wandering_modules.html#SlowSumOfBumpFcns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.ml.wandering_modules.SlowSumOfBumpFcns" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#janelia_core.ml.wandering_modules.WanderingModule" title="janelia_core.ml.wandering_modules.WanderingModule"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WanderingModule</span></code></a></p>
<p>Implements a sum of bump functions which will be slower in computation on GPU, but may be have memory benefits.</p>
<p>(See BumpFcn for the functional form of a single bump function).</p>
<p>Creates a new SumOfBumpFcns modules.
This module allows for bounding of centers and widths and perturbing of gradients.</p>
<dl>
<dt>Args:</dt><dd><p>c: Initial centers.  Each column is a center for a bump.</p>
<p>w: Initial widths.  Each column is the width parameters for a bump.</p>
<p>m: Initial magnitudes.  Each entry is the magnitude for a bump.</p>
<p>c_bounds: Bounds for the center parameter.  First column is lower bounds; second column is upper bounds. If
None, the center will not be bounded.</p>
<p>w_bounds: Bounds for the width parameter.  First column is lower bounds; second column is upper bounds. If
None, the width parameters will not be bounded.</p>
<p>c_grad_std: The standard deviation to use when perturbing gradients for the center parameters with random
noise</p>
<p>w_grad_std: The standard deviation to use when perturbing gradients for the width parameters with random
noise</p>
<p>m_grad_gain: The gain to use when perturbing the gradient for the magnitude.  The gradient is perturbed by
subtracting the value m*grad_gain from the gradient for m.</p>
<p>support_p: The percent of max value in any direction where we define the boundary of support.  This is
used for skipping function evaluation for input values that are outside of the support.</p>
</dd>
</dl>
<dl class="py method">
<dt id="janelia_core.ml.wandering_modules.SlowSumOfBumpFcns.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../../../../_modules/janelia_core/ml/wandering_modules.html#SlowSumOfBumpFcns.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.ml.wandering_modules.SlowSumOfBumpFcns.forward" title="Permalink to this definition"></a></dt>
<dd><p>Computes output from input.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>x: input of shape n_smps*d_in</p>
</dd>
<dt>Returns:</dt><dd><p>y: output of length n_smps</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="janelia_core.ml.wandering_modules.SlowSumOfBumpFcns.bound">
<code class="sig-name descname">bound</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/janelia_core/ml/wandering_modules.html#SlowSumOfBumpFcns.bound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.ml.wandering_modules.SlowSumOfBumpFcns.bound" title="Permalink to this definition"></a></dt>
<dd><p>Bounds parameters in the module.</p>
<p>This method takes no arguments, other than self, as the bounds themselves are expected to be saved as attributes
of the module.</p>
</dd></dl>

<dl class="py method">
<dt id="janelia_core.ml.wandering_modules.SlowSumOfBumpFcns.pert_grads">
<code class="sig-name descname">pert_grads</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/janelia_core/ml/wandering_modules.html#SlowSumOfBumpFcns.pert_grads"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.ml.wandering_modules.SlowSumOfBumpFcns.pert_grads" title="Permalink to this definition"></a></dt>
<dd><p>Perturbs (or adjusts) gradients of parameters of the module.</p>
<p>This method takes no arguments, other than self, as any customization of how gradients are perturbed should
be controlled through adjusting attributes of the module.  For example, the amount of noise added to gradients
could be determined by an attribute.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../utils/index.html" class="btn btn-neutral float-left" title="janelia_core.ml.utils" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../registration/index.html" class="btn btn-neutral float-right" title="janelia_core.registration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, William Bishop.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>