<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>janelia_core.stats.permutation_tests &mdash; janelia_core 1.0 documentation</title><link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="janelia_core.stats.regression" href="../regression/index.html" />
    <link rel="prev" title="janelia_core.stats.multiple_comparisons" href="../multiple_comparisons/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> janelia_core
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../install.html">Setting up the core library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../install.html#dependencies">Dependencies</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">janelia_core</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../cell_extraction/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.cell_extraction</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dataprocessing/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.dataprocessing</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../fileio/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.fileio</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../math/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.math</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ml/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.ml</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../registration/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.registration</span></code></a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.stats</span></code></a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../index.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.utils</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../visualization/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.visualization</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">janelia_core</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core</span></code></a> &raquo;</li>
          <li><a href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.stats</span></code></a> &raquo;</li>
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.stats.permutation_tests</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/autoapi/janelia_core/stats/permutation_tests/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-janelia_core.stats.permutation_tests">
<span id="janelia-core-stats-permutation-tests"></span><h1><a class="reference internal" href="#module-janelia_core.stats.permutation_tests" title="janelia_core.stats.permutation_tests"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.stats.permutation_tests</span></code></a><a class="headerlink" href="#module-janelia_core.stats.permutation_tests" title="Permalink to this headline"></a></h1>
<p>Contains tools for performing permutation tests.</p>
<div class="section" id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this headline"></a></h2>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline"></a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#janelia_core.stats.permutation_tests.basic_perm_test" title="janelia_core.stats.permutation_tests.basic_perm_test"><code class="xref py py-obj docutils literal notranslate"><span class="pre">basic_perm_test</span></code></a>(x_0: numpy.ndarray, x_1: numpy.ndarray, n_perms: int = 1000, f: Callable = None) → Tuple[float, float]</p></td>
<td><p>Performs a basic permutation test.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#janelia_core.stats.permutation_tests.paired_grouped_perm_test" title="janelia_core.stats.permutation_tests.paired_grouped_perm_test"><code class="xref py py-obj docutils literal notranslate"><span class="pre">paired_grouped_perm_test</span></code></a>(x0: numpy.ndarray, x1: numpy.ndarray, grp_ids: numpy.ndarray, pair_f: Callable = None, reduce_f: Callable = None, n_perms: int = 1000) → Tuple[float, float]</p></td>
<td><p>Performs a paired, grouped permutation test.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#janelia_core.stats.permutation_tests.all_pairs_perm_tests" title="janelia_core.stats.permutation_tests.all_pairs_perm_tests"><code class="xref py py-obj docutils literal notranslate"><span class="pre">all_pairs_perm_tests</span></code></a>(x: Sequence[numpy.ndarray], test_opts: dict = None, update_int=10) → numpy.ndarray</p></td>
<td><p>Performs a set of permutation tests between all pairs of conditions.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt id="janelia_core.stats.permutation_tests.basic_perm_test">
<code class="sig-prename descclassname">janelia_core.stats.permutation_tests.</code><code class="sig-name descname">basic_perm_test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x_0</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">x_1</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">n_perms</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">f</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span><a class="reference internal" href="../../../../_modules/janelia_core/stats/permutation_tests.html#basic_perm_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.permutation_tests.basic_perm_test" title="Permalink to this definition"></a></dt>
<dd><p>Performs a basic permutation test.</p>
<p>This function calculates the p value for a statistic of the form:</p>
<blockquote>
<div><p>t = abs(f(x_0) - f(x_1)),</p>
</div></blockquote>
<p>where f() is by default median().  In this case, the p-value is for the difference of medians of two
samples.  However, the user can specify custom f functions (e.g., mean) to calculate the p-value
for other statistics.</p>
<dl>
<dt>Args:</dt><dd><p>x_0: Data from condition 0.  Should be either 1 or 2-d array.  Each row is a sample.</p>
<p>x_1: Data from condition 1.  Should be either 1 or 2-d array.  Each row is a sample.
Note: x_1 can have a different number of samples than x_0.</p>
<p>n_perms: The number of permutations to perform.</p>
<p>f: The f function to use (see above).  If None, median will be used.  If samples have a dimensionality greater
than 1, a custom f function must be used.</p>
</dd>
<dt>Returns:</dt><dd><p>p: The p value for the calculated statistic</p>
<p>t: The calculated statistic</p>
</dd>
<dt>Raises:</dt><dd><p>TypeError: If x_0 or x_1 are not of type np.ndarray
ValueError: If x_0 and x_1 do not have at least one sample each
ValueError: If samples have a dimensionality greater than 1 but the default f is used.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="janelia_core.stats.permutation_tests.paired_grouped_perm_test">
<code class="sig-prename descclassname">janelia_core.stats.permutation_tests.</code><code class="sig-name descname">paired_grouped_perm_test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x0</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">x1</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">grp_ids</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">pair_f</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reduce_f</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_perms</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1000</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span><a class="reference internal" href="../../../../_modules/janelia_core/stats/permutation_tests.html#paired_grouped_perm_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.permutation_tests.paired_grouped_perm_test" title="Permalink to this definition"></a></dt>
<dd><p>Performs a paired, grouped permutation test.</p>
<p>This calculates paired statistics.  In otherwords, we assume each sample from condition 0 is paired with a sample
from condition 1.   The user can specify the function (e.g., abs(x1 - x0)) which is used to compare the samples. We
then test against the null hypothesis that x1 and x0 come from the same distribution.</p>
<p>This is also for performing permutation tests when samples are grouped.  A good example of this is when we obtain
multiple samples from one subject. In this case all the samples from one subject will form one group. Because we
expect that samples in the same group may not be truly independent, we need to take this into account when
performing permutations and permute all the samples from a group together.  This is what this test does.  It is
essentially a standard permutation test, except samples in groups are shuffled together.</p>
<dl>
<dt>Args:</dt><dd><p>x0: Array of samples from condition 0.  Each row is a sample.  Samples from all groups are concatenated together.</p>
<p>x1: Array of samples from condition 1.  Rows of x1 are paired with rows of x0.</p>
<p>grp_ids: a 1-d array indicating groups of samples.  Samples from the same group should
have the same value in g.</p>
<p>pair_f: The function used to compare x0 and x1.  If None, the function x1 - x0 will be used.</p>
<p>reduce_f: The function used to calculate a single statistic from the results of pair_f.  If None, the function
mean() will be used.</p>
</dd>
<dt>Returns:</dt><dd><p>t: The value of the test statistic</p>
<p>p: The p-value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="janelia_core.stats.permutation_tests.all_pairs_perm_tests">
<code class="sig-prename descclassname">janelia_core.stats.permutation_tests.</code><code class="sig-name descname">all_pairs_perm_tests</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">test_opts</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">update_int</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../../../../_modules/janelia_core/stats/permutation_tests.html#all_pairs_perm_tests"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.permutation_tests.all_pairs_perm_tests" title="Permalink to this definition"></a></dt>
<dd><p>Performs a set of permutation tests between all pairs of conditions.</p>
<dl>
<dt>Args:</dt><dd><p>x: x[i] is a numpy array of samples for condition i.  x[i] should either be a 1-d or 2-d numpy array, where
each row is a sample.  Different entries of x can have different number of samples.</p>
<p>test_opts: A dictionary of keyword arguments to pass into the call to basic_perm_test for each test.</p>
<p>update_int: Progress is printed to screen every update_int number of tests.</p>
</dd>
<dt>Returns:</dt><dd><p>p_vls: p_vls[i,j] is the p value when testing the difference between x[i] and x[j].  To save computation, we
set p_vls[j,i] = p_vls[i,j].  The diagonal of p_vls will be nan.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../multiple_comparisons/index.html" class="btn btn-neutral float-left" title="janelia_core.stats.multiple_comparisons" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../regression/index.html" class="btn btn-neutral float-right" title="janelia_core.stats.regression" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, William Bishop.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>