<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>janelia_core.stats.regression &mdash; janelia_core 0.1 documentation</title><link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> janelia_core
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">janelia_core</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.stats.regression</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/autoapi/janelia_core/stats/regression/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-janelia_core.stats.regression">
<span id="janelia-core-stats-regression"></span><h1><a class="reference internal" href="#module-janelia_core.stats.regression" title="janelia_core.stats.regression"><code class="xref py py-mod docutils literal notranslate"><span class="pre">janelia_core.stats.regression</span></code></a><a class="headerlink" href="#module-janelia_core.stats.regression" title="Permalink to this headline"></a></h1>
<p>Tools for computing statistics in various ways when working with linear regression models.</p>
<p>The tools provided here are designed for use when assumptions underlying standard approaches to computing statistics
for linear regression models do not apply.  In particular, there are multiple methods for handling grouped errors as
well as methods for computing statistics via boostrap methods.</p>
<div class="section" id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this headline"></a></h2>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline"></a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#janelia_core.stats.regression.corr" title="janelia_core.stats.regression.corr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">corr</span></code></a>(x: numpy.ndarray, y: numpy.ndarray) → Union[float, numpy.ndarray]</p></td>
<td><p>Calculates the pearson correlation between two series of data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#janelia_core.stats.regression.normalized_r_squared" title="janelia_core.stats.regression.normalized_r_squared"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalized_r_squared</span></code></a>(truth: numpy.ndarray, pred: numpy.ndarray) → float</p></td>
<td><p>Computes normalized r-squared for a collection of variables.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#janelia_core.stats.regression.r_squared" title="janelia_core.stats.regression.r_squared"><code class="xref py py-obj docutils literal notranslate"><span class="pre">r_squared</span></code></a>(truth: numpy.ndarray, pred: numpy.ndarray) → numpy.ndarray</p></td>
<td><p>Computes the r-squared value for a collection of variables.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#janelia_core.stats.regression.grouped_linear_regression_boot_strap" title="janelia_core.stats.regression.grouped_linear_regression_boot_strap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grouped_linear_regression_boot_strap</span></code></a>(y: numpy.ndarray, x: numpy.ndarray, g: numpy.ndarray, n_bs_smps: int, include_mean: bool = True, rcond: float = None) → Tuple[numpy.ndarray, numpy.ndarray]</p></td>
<td><p>Fits a linear regression model, performing a grouped bootstrap to get confidence intervals on coefficients.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#janelia_core.stats.regression.grouped_linear_regression_wild_bootstrap" title="janelia_core.stats.regression.grouped_linear_regression_wild_bootstrap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grouped_linear_regression_wild_bootstrap</span></code></a>(y: numpy.ndarray, x: numpy.ndarray, g: numpy.ndarray, test_coefs: Sequence[int] = None, n_bs_smps: int = 1000, rcond: float = None) → numpy.ndarray</p></td>
<td><p>Computes a linear model and stats using a wild bootstrap.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#janelia_core.stats.regression.grouped_linear_regression_ols_estimator" title="janelia_core.stats.regression.grouped_linear_regression_ols_estimator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grouped_linear_regression_ols_estimator</span></code></a>(y: numpy.ndarray, x: numpy.ndarray, g: numpy.ndarray, rcond: float = None) → Tuple[numpy.ndarray, numpy.ndarray, int]</p></td>
<td><p>Fits a linear model and stats using optimal least squares, accounting for grouped errors.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#janelia_core.stats.regression.grouped_linear_regression_within_estimator" title="janelia_core.stats.regression.grouped_linear_regression_within_estimator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grouped_linear_regression_within_estimator</span></code></a>(y: numpy.ndarray, x: numpy.ndarray, g: numpy.ndarray, rcond: float = None) → Tuple[numpy.ndarray, numpy.ndarray, dict, int]</p></td>
<td><p>Computes linear model and stats using the within estimator for a fixed-effects linear model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#janelia_core.stats.regression.grouped_linear_regression_acm_stats" title="janelia_core.stats.regression.grouped_linear_regression_acm_stats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grouped_linear_regression_acm_stats</span></code></a>(beta, acm, n_grps, alpha) → dict</p></td>
<td><p>Calculates statistics given an estimate of an asymptotic covariance matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#janelia_core.stats.regression.grouped_linear_regression_acm_linear_restriction_stats" title="janelia_core.stats.regression.grouped_linear_regression_acm_linear_restriction_stats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grouped_linear_regression_acm_linear_restriction_stats</span></code></a>(beta: numpy.ndarray, acm: numpy.ndarray, r: numpy.ndarray, q: numpy.ndarray, n_grps: int) → float</p></td>
<td><p>Given an asymptotic covariance matrix from linear regression, tests significance of linear restrictions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#janelia_core.stats.regression.naive_regression" title="janelia_core.stats.regression.naive_regression"><code class="xref py py-obj docutils literal notranslate"><span class="pre">naive_regression</span></code></a>(y: numpy.ndarray, x: numpy.ndarray) → Tuple[numpy.ndarray, numpy.ndarray]</p></td>
<td><p>Performs “naive” regression to predict x from y.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#janelia_core.stats.regression.visualize_boot_strap_results" title="janelia_core.stats.regression.visualize_boot_strap_results"><code class="xref py py-obj docutils literal notranslate"><span class="pre">visualize_boot_strap_results</span></code></a>(bs_values: numpy.ndarray, var_strs: Sequence, theta: numpy.ndarray = None, var_clrs: numpy.ndarray = None, violin_plots: bool = True, plot_c_ints: bool = True, show_nz_sig: bool = True, plot_zero_line: bool = True, alpha: float = 0.05, theta_size: int = 5, er_bar_pts: int = 2, sig_size: int = 5, sig_y_vl: float = None, ax: matplotlib.pyplot.axes = None) → matplotlib.pyplot.axes</p></td>
<td><p>For visualizing the results of grouped_linear_regression_boot_strap.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#janelia_core.stats.regression.grouped_linear_regression_boot_strap_stats" title="janelia_core.stats.regression.grouped_linear_regression_boot_strap_stats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grouped_linear_regression_boot_strap_stats</span></code></a>(bs_values: numpy.ndarray, alpha: float = 0.05) → dict</p></td>
<td><p>For getting statistics from the results of grouped_linear_regression_boot_strap.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#janelia_core.stats.regression.linear_regression_ols_estimator" title="janelia_core.stats.regression.linear_regression_ols_estimator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">linear_regression_ols_estimator</span></code></a>(y: numpy.ndarray, x: numpy.ndarray, rcond: float = None) → Tuple[numpy.ndarray, numpy.ndarray]</p></td>
<td><p>Fits a linear model and stats using optimal least squares.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#janelia_core.stats.regression.visualize_coefficient_stats" title="janelia_core.stats.regression.visualize_coefficient_stats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">visualize_coefficient_stats</span></code></a>(var_strs: Sequence, theta: numpy.ndarray = None, c_ints: numpy.ndarray = None, var_clrs: numpy.ndarray = None, sig: numpy.ndarray = None, er_bar_pts: int = 2, theta_size=5, sig_size: int = 5, sig_y_vl: float = None, x_axis_rot: float = -75, ax: matplotlib.pyplot.axes = None, plot_zero_line: bool = True) → matplotlib.pyplot.axes</p></td>
<td><p>For visualizing estimated coefficients with confidence intervals.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt id="janelia_core.stats.regression.corr">
<code class="sig-prename descclassname">janelia_core.stats.regression.</code><code class="sig-name descname">corr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">y</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a><span class="p">, </span>numpy.ndarray<span class="p">]</span><a class="reference internal" href="../../../../_modules/janelia_core/stats/regression.html#corr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.regression.corr" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the pearson correlation between two series of data.</p>
<p>If the data is multi-dimensional, the pearson correlation is calculated for each dimension.</p>
<dl>
<dt>Args:</dt><dd><p>x: One set of data of shape n_smps*n_dim</p>
<p>y: The other set of data; same shape as x</p>
</dd>
<dt>Returns:</dt><dd><p>pearson_corr: The pearson correlation between x and y.  If x &amp; y are multidimensional, then pearson_corr
is an array and pearson_corr[i] is the correlation for dimension i.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="janelia_core.stats.regression.normalized_r_squared">
<code class="sig-prename descclassname">janelia_core.stats.regression.</code><code class="sig-name descname">normalized_r_squared</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">truth</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">pred</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a><a class="reference internal" href="../../../../_modules/janelia_core/stats/regression.html#normalized_r_squared"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.regression.normalized_r_squared" title="Permalink to this definition"></a></dt>
<dd><p>Computes normalized r-squared for a collection of variables.</p>
<p>Normalized r-squared is defined as follows:  1 - ( sum r_i) / ( sum s_i), where:</p>
<blockquote>
<div><p>r_i is the squared error between predictions and truth for variable i and s_i is the squared error
of variable i between the mean value and truth.</p>
</div></blockquote>
<p>Normalized squared error is equal to standard r-squared when there is only one variable.  When there
is more than one variable but all variables have the same variance, then normalized r-squared is equal
to the average of the r-squared values for each individual variable.  However, when some variables have
higher variance than others, normalized r-squared weights those with higher variance more than those with
less variance.</p>
<dl>
<dt>Args:</dt><dd><p>truth: True data of shape n_smps*n_vars</p>
<p>pred: Predicated data of shape n_smps*n_vars</p>
</dd>
<dt>Returns:</dt><dd><p>norm_r_sq: The normlaized r-squared</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="janelia_core.stats.regression.r_squared">
<code class="sig-prename descclassname">janelia_core.stats.regression.</code><code class="sig-name descname">r_squared</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">truth</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">pred</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../../../../_modules/janelia_core/stats/regression.html#r_squared"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.regression.r_squared" title="Permalink to this definition"></a></dt>
<dd><p>Computes the r-squared value for a collection of variables.</p>
<p>Computes the proportion of variance predicted variables capture of ground truth variables.</p>
<dl>
<dt>Args:</dt><dd><p>truth: True data of shape n_smps*n_vars</p>
<p>pred: Predicated data of shape n_smps*n_vars</p>
</dd>
<dt>Returns:</dt><dd><p>r_sq: r_sq[i] contains the r-squared value for pred[:, i]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="janelia_core.stats.regression.grouped_linear_regression_boot_strap">
<code class="sig-prename descclassname">janelia_core.stats.regression.</code><code class="sig-name descname">grouped_linear_regression_boot_strap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">g</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">n_bs_smps</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></span></em>, <em class="sig-param"><span class="n">include_mean</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">rcond</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>numpy.ndarray<span class="p">]</span><a class="reference internal" href="../../../../_modules/janelia_core/stats/regression.html#grouped_linear_regression_boot_strap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.regression.grouped_linear_regression_boot_strap" title="Permalink to this definition"></a></dt>
<dd><p>Fits a linear regression model, performing a grouped bootstrap to get confidence intervals on coefficients.</p>
<p>By grouped bootstrap, we mean samples are selected in groups.</p>
<p>This function returns the coefficients for each bootstrap sample.  Use grouped_linear_regression_boot_strap_stats
to compute statistics (such as confidence intervals on the coefficients) and visualize_boot_strap_results to
visualize a summary of the fit results.</p>
<dl>
<dt>Args:</dt><dd><p>y: 1-d array of the predicted variable.  Of length n_smps.</p>
<p>x: Variables to predict from.  Of shape n_smps*d_x.</p>
<p>g: 1-d array indicating groups of samples.  Of length n_smps.  Samples from the same group should
have the same value in g.</p>
<p>n_bs_smps: The number of boot strap samples to draw</p>
<p>include_mean: True if models should have a mean term included.  False if not.</p>
<p>rcond: The value of rcond to provide to the least squares fitting.  See np.linalg.lstsq.</p>
</dd>
<dt>Returns:</dt><dd><p>bs_beta: Of shape n_boot_strap_smps*n_coefs.  bs_beta[i,:] contains the coefficients of the linear regression
model for the i^th bootstrap sample.  If include_mean is True, the last column of bs_beta contains the mean.</p>
<p>beta: The beta fit to the data.  If include_mean is True, the last entry of bs_beta contains the mean.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="janelia_core.stats.regression.grouped_linear_regression_wild_bootstrap">
<code class="sig-prename descclassname">janelia_core.stats.regression.</code><code class="sig-name descname">grouped_linear_regression_wild_bootstrap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">g</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">test_coefs</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_bs_smps</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></span> <span class="o">=</span> <span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">rcond</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../../../../_modules/janelia_core/stats/regression.html#grouped_linear_regression_wild_bootstrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.regression.grouped_linear_regression_wild_bootstrap" title="Permalink to this definition"></a></dt>
<dd><p>Computes a linear model and stats using a wild bootstrap.</p>
<p>For group g, the model for the i^th observation is of the form:</p>
<blockquote>
<div><p>y_gi = x_gi^Teta + o_g + ep_gi,</p>
</div></blockquote>
<p>where x_gi are predictor variables of dimension P, o_g is a group offset and ep_gi is zero-mean noise.  In this
model, it assumes all groups shared the same eta but each group gets its own o_g and ep_gi.</p>
<p>This function will estimate beta as well as p-values that individual coefficients in beta are non-zero.</p>
<p>The bootstrap procedure is based on the “Wild Cluster bootstrap-t with H0 imposed” bootstrap described in:</p>
<blockquote>
<div><p>“Boostrap-based Improvements for Inference with Clustered Errors”by Cameron, Gelback &amp; Miller, 2008</p>
</div></blockquote>
<p>Within each boostrap iteration, the standard-error needed for calculating Wald statistics is estimated with the
within estimator of:</p>
<blockquote>
<div><p>“Computing Robust Standard Errors for Within-groups Estimators” by M. Arellano, 1987,</p>
</div></blockquote>
<p>where a small-sample correction is also applied as recommended in:</p>
<blockquote>
<div><p>“A Practioner’s Guide to Cluster-Robust Inference” by A. Cameron and Douglas Miller, 2015.</p>
</div></blockquote>
<dl>
<dt>Args:</dt><dd><p>y: 1-d array of the predicted variable.  Of length n_smps.</p>
<p>x: Variables to predict from.  Of shape n_smps*d_x.</p>
<p>g: 1-d array indicating groups of samples.  Of length n_smps.  Samples from the same group should
have the same value in g.</p>
<p>test_coefs: If None, statistical significant that each individual entry in eta is different than 0 will be
calculated.  If not, this is a list of indices of beta to test for</p>
<p>n_bs_smps: The number of bootstrap samples to use when calculating p-values.</p>
<p>rcond: The value of rcond to provide to the least squares fitting within the call to
grouped_linear_regression_within_estimator.  See that function as well np.linalg.lstsq.</p>
</dd>
<dt>Returns:</dt><dd><p>p_vls: The computed p-values for rejecting the null hypothesis that each coefficient is 0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="janelia_core.stats.regression.grouped_linear_regression_ols_estimator">
<code class="sig-prename descclassname">janelia_core.stats.regression.</code><code class="sig-name descname">grouped_linear_regression_ols_estimator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">g</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">rcond</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>numpy.ndarray<span class="p">, </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a><span class="p">]</span><a class="reference internal" href="../../../../_modules/janelia_core/stats/regression.html#grouped_linear_regression_ols_estimator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.regression.grouped_linear_regression_ols_estimator" title="Permalink to this definition"></a></dt>
<dd><p>Fits a linear model and stats using optimal least squares, accounting for grouped errors.</p>
<blockquote>
<div><p>For group g, the model for the i^th observation is of the form:</p>
<blockquote>
<div><p>y_gi = x_gi^Teta + ep_gi,</p>
</div></blockquote>
</div></blockquote>
<p>where x_gi are predictor variables of dimension P, and ep_gi is noise.  In this model, it assumes all groups shared
the same eta but each group gets its own ep_gi.</p>
<p>Note: A small sample correction is applied when calculating the asymptotic covariance matrix, as outlined in</p>
<blockquote>
<div><p>“A Practioner’s Guide to Cluster-Robust Inference” by A. Cameron and Douglas Miller, 2015.</p>
</div></blockquote>
<dl>
<dt>Args:</dt><dd><p>y: 1-d array of the predicted variable.  Of length n_smps.</p>
<p>x: Variables to predict from.  Of shape n_smps*d_x.</p>
<p>g: 1-d array indicating groups of samples.  Of length n_smps.  Samples from the same group should
have the same value in g.</p>
<p>rcond: The value of rcond to provide to the least squares fitting.  See np.linalg.lstsq.</p>
</dd>
<dt>Returns:</dt><dd><p>beta: The estimate of beta</p>
<p>acm: The asymptotic covariance matrix for beta.</p>
<p>n_grps: The number of groups in the analysis</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: If the number of samples does not exceed the number of x variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="janelia_core.stats.regression.grouped_linear_regression_within_estimator">
<code class="sig-prename descclassname">janelia_core.stats.regression.</code><code class="sig-name descname">grouped_linear_regression_within_estimator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">g</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">rcond</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>numpy.ndarray<span class="p">, </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a><span class="p">, </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a><span class="p">]</span><a class="reference internal" href="../../../../_modules/janelia_core/stats/regression.html#grouped_linear_regression_within_estimator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.regression.grouped_linear_regression_within_estimator" title="Permalink to this definition"></a></dt>
<dd><p>Computes linear model and stats using the within estimator for a fixed-effects linear model.</p>
<p>For group g, the model for the i^th observation is of the form:</p>
<blockquote>
<div><p>y_gi = x_gi^Teta + o_g + ep_gi,</p>
</div></blockquote>
<p>where x_gi are predictor variables of dimension P, o_g is a group offset and ep_gi is zero-mean noise.  In this model,
it assumes all groups shared the same eta but each group gets its own o_g and ep_gi.</p>
<p>This function will estimate beta as well as the asymptotic covariance matrix for beta using the method of:</p>
<blockquote>
<div><p>“Computing Robust Standard Errors for Within-groups Estimators” by M. Arellano, 1987.</p>
</div></blockquote>
<p>It will then apply a finite sample correction as recommended in:</p>
<blockquote>
<div><p>“A Practioner’s Guide to Cluster-Robust Inference” by A. Cameron and Douglas Miller, 2015.</p>
</div></blockquote>
<dl>
<dt>Args:</dt><dd><p>y: 1-d array of the predicted variable.  Of length n_smps.</p>
<p>x: Variables to predict from.  Of shape n_smps*d_x.</p>
<p>g: 1-d array indicating groups of samples.  Of length n_smps.  Samples from the same group should
have the same value in g.</p>
<p>rcond: The value of rcond to provide to the least squares fitting.  See np.linalg.lstsq.</p>
</dd>
<dt>Returns:</dt><dd><p>beta: The estimate of beta</p>
<p>acm: The asymptotic covariance matrix for beta.</p>
<p>offsets: A dictionary with the o_g values for each group.  Keys will be values of g used to indicate groups and
values will be the offset for each group.</p>
<p>n_grps: The number of groups in the analysis</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="janelia_core.stats.regression.grouped_linear_regression_acm_stats">
<code class="sig-prename descclassname">janelia_core.stats.regression.</code><code class="sig-name descname">grouped_linear_regression_acm_stats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">beta</span></em>, <em class="sig-param"><span class="n">acm</span></em>, <em class="sig-param"><span class="n">n_grps</span></em>, <em class="sig-param"><span class="n">alpha</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a><a class="reference internal" href="../../../../_modules/janelia_core/stats/regression.html#grouped_linear_regression_acm_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.regression.grouped_linear_regression_acm_stats" title="Permalink to this definition"></a></dt>
<dd><p>Calculates statistics given an estimate of an asymptotic covariance matrix.</p>
<p>Confidence intervals and p-values for individual coefficients are calculated assuming a t-distribution on the
estimates for the individual entries of beta.</p>
<dl>
<dt>Args:</dt><dd><p>beta: The estimate of beta</p>
<p>acm: The asymptotic variance matrix for beta</p>
<p>n_grps: The number of groups in the original regression</p>
<p>alpha: The alpha value to use when constructing 1-alpha confidence intervals</p>
</dd>
<dt>Returns:</dt><dd><p>stats: A dictionary with the following keys:</p>
<blockquote>
<div><p>alpha: The alpha value for which confidence intervals were calculated.</p>
<p>c_ints: Confidence intervals.  c_ints[:,i] is the 1-alpha percentile confidence interval for beta[i]</p>
<p>non_zero_p: Indicates the p-value for null hypothesis that beta[i] is 0.</p>
<p>non_zero: non_zero[i] is true if the confidence interval for beta[i] does not contain 0.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="janelia_core.stats.regression.grouped_linear_regression_acm_linear_restriction_stats">
<code class="sig-prename descclassname">janelia_core.stats.regression.</code><code class="sig-name descname">grouped_linear_regression_acm_linear_restriction_stats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">beta</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">acm</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">r</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">q</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">n_grps</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a><a class="reference internal" href="../../../../_modules/janelia_core/stats/regression.html#grouped_linear_regression_acm_linear_restriction_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.regression.grouped_linear_regression_acm_linear_restriction_stats" title="Permalink to this definition"></a></dt>
<dd><p>Given an asymptotic covariance matrix from linear regression, tests significance of linear restrictions.</p>
<p>Given a vector of K-coefficients, beta, we desire to produce a p-value for a null hypothesis taking the form of
J linear restrictions, which can be written as:</p>
<p>r*beta = q, where r is a matrix of size J by K and q is a vector of length J.</p>
<p>This function was based heavily on chapter 5 of Greene, Econometric Analysis.  In addition, to this
reference a good reference on Wald tests (the Wikipedia article is not a bad place to start) may also be
useful.</p>
<p>The basic approach we take here is we assume:</p>
<p>1) The distribution on beta is well approximated as a normal distribution with the asymptotic covariance matrix
provided to this function.</p>
<ol class="arabic" start="2">
<li><p>Under this assumption, we can compute the F-statistic (see Greene), which is defined as:</p>
<blockquote>
<div><p>F = [r*beta - q]’ (r’ * acm * r)^{-1} [r*beta - q]/J,</p>
<p>which has a distribution equal to 1/J times a Chi-squared distribution with K degrees of freedom.</p>
</div></blockquote>
</li>
</ol>
<p>3) We can in principle calculate critical values comparing F*J to critical values from a Chi-square distribution.
However, again following Greene, we choose to use critical values from the F-distribution, which is more
conservative.  Specifically, we compare F (no need now to multiply by J) to the critical values from the
F(J, n_grps - K) distribution.</p>
<p>Note: This function can be used for computing statistics for linear restrictions of non-grouped results as well.
In this case, n_grps should just be seq equal to the number of samples in the data.</p>
<dl>
<dt>Args:</dt><dd><p>beta: The beta vector which was estimated</p>
<p>acm: The estimated asymptotic covariance matrix</p>
<p>r: The r matrix for linear restrictions.  Each row is a restriction.</p>
<p>q: The q vector for linear restrictions.</p>
<p>n_grps: The number of groups in the original data</p>
</dd>
<dt>Returns:</dt><dd><p>p: The calculated p value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="janelia_core.stats.regression.naive_regression">
<code class="sig-prename descclassname">janelia_core.stats.regression.</code><code class="sig-name descname">naive_regression</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>numpy.ndarray<span class="p">]</span><a class="reference internal" href="../../../../_modules/janelia_core/stats/regression.html#naive_regression"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.regression.naive_regression" title="Permalink to this definition"></a></dt>
<dd><p>Performs “naive” regression to predict x from y.</p>
<p>By naive regression, we assume that all x variables are mutually independent. The parameters this
function provides is the correct regression model for this case.  If not all variables are
independent, the parameters returned by this function are sub-optimal.</p>
<p>This function will return the parameters, b (a matrix) and o (a vector of offsets) to predict:</p>
<p>y_i = x_i^T*b + o</p>
<p>where we asume y_i in R^m and x_i in R^p.</p>
<dl>
<dt>Args:</dt><dd><p>y: Data to predict of shape [n_smps, m]</p>
<p>x: Data to predict from of shape [n_smps, p]</p>
</dd>
<dt>Returns:</dt><dd><p>b: the b matrix above</p>
<p>o: the offset vector above</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="janelia_core.stats.regression.visualize_boot_strap_results">
<code class="sig-prename descclassname">janelia_core.stats.regression.</code><code class="sig-name descname">visualize_boot_strap_results</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bs_values</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">var_strs</span><span class="p">:</span> <span class="n">Sequence</span></em>, <em class="sig-param"><span class="n">theta</span><span class="p">:</span> <span class="n">numpy.ndarray</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">var_clrs</span><span class="p">:</span> <span class="n">numpy.ndarray</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">violin_plots</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">plot_c_ints</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">show_nz_sig</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">plot_zero_line</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></span> <span class="o">=</span> <span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">theta_size</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">er_bar_pts</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></span> <span class="o">=</span> <span class="default_value">2</span></em>, <em class="sig-param"><span class="n">sig_size</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">sig_y_vl</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ax</span><span class="p">:</span> <span class="n">matplotlib.pyplot.axes</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; matplotlib.pyplot.axes<a class="reference internal" href="../../../../_modules/janelia_core/stats/regression.html#visualize_boot_strap_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.regression.visualize_boot_strap_results" title="Permalink to this definition"></a></dt>
<dd><p>For visualizing the results of grouped_linear_regression_boot_strap.</p>
<dl>
<dt>Args:</dt><dd><p>bs_values: The coefficients for each bootstrap sample. bs_values[i,:] are the coefficients for bootstrap sample
i.</p>
<p>var_strs: The names of each of the coefficients in bs_values.</p>
<p>theta: Point estimates for each coefficient.  If None, point values will not be plotted.</p>
<p>var_clrs: Of shape n_coefs*3.  var_clrs[i,:] is a color for plotting the values associated with coefficient i.</p>
<p>violin_plots: If true, violin plots of coefficient values will be plotted.</p>
<p>plot_c_ints: True if confidence intervals for each coefficient should be plotted.</p>
<p>plot_zero_line: True if a dotted line denoting 0 should be added to the plot.</p>
<p>show_nz_sig: True if coefficients significantly different than 0 should be denoted with stars. This is
computed simply by testing if the confidence interval for a coefficient contains 0.</p>
<p>alpha: The alpha value for constructing confidence intervals and determining if coefficients are significantly
different than 0.</p>
<p>theta_size: The size of the marker to use when plotting point estimages of coefficients.</p>
<p>er_bar_pts: The width of error bars to plot for confidence intervals.</p>
<p>sig_size: The size of the marker to use when denoting which coefficients are significanly different 0.</p>
<p>sig_y_vl: If not None, this is the y-value used for showing significant stars.</p>
<p>ax: The axis to plot into.  If none, one will be created.</p>
</dd>
<dt>Returns:</dt><dd><p>ax: The axes the plot was created in</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="janelia_core.stats.regression.grouped_linear_regression_boot_strap_stats">
<code class="sig-prename descclassname">janelia_core.stats.regression.</code><code class="sig-name descname">grouped_linear_regression_boot_strap_stats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bs_values</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></span> <span class="o">=</span> <span class="default_value">0.05</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a><a class="reference internal" href="../../../../_modules/janelia_core/stats/regression.html#grouped_linear_regression_boot_strap_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.regression.grouped_linear_regression_boot_strap_stats" title="Permalink to this definition"></a></dt>
<dd><p>For getting statistics from the results of grouped_linear_regression_boot_strap.</p>
<p>This function will compute:</p>
<blockquote>
<div><p>1) Confidence intervals for each coefficient.  Currently percentile confidence intervals are computed. See
“All of Statistics” by Wasserman for more information on percentile confidence intervals for the bootstrap.</p>
<p>2) P-values that coefficients are significantly different than 0, based on inverting percentile confidence
intervals</p>
</div></blockquote>
<dl>
<dt>Args:</dt><dd><p>bs_values: The results of grouped_linear_regresson_boot_strap.  bs_vls[i,:] are the coefficient for
the i^th bootstrap sample.</p>
<p>alpha: The alpha values to use when computing confidence intervals</p>
</dd>
<dt>Returns:</dt><dd><p>stats: A dictionary with the following keys:</p>
<blockquote>
<div><p>alpha: The alpha value for which confidence intervals were calculated.</p>
<p>c_ints: Confidence intervals.  c_ints[:,i] is the 1-alpha percentile confidence interval for coefficient i.</p>
<p>non_zero_p: Indicates the p-value for null hypothesis that the coefficient is 0.</p>
<p>non_zero: Indicates coefficients with 1-alpha confidence intervals which do not contain 0.  non_zero[i] is
true if the confidence interval for coefficient i does not contain 0.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="janelia_core.stats.regression.linear_regression_ols_estimator">
<code class="sig-prename descclassname">janelia_core.stats.regression.</code><code class="sig-name descname">linear_regression_ols_estimator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">rcond</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>numpy.ndarray<span class="p">, </span>numpy.ndarray<span class="p">]</span><a class="reference internal" href="../../../../_modules/janelia_core/stats/regression.html#linear_regression_ols_estimator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.regression.linear_regression_ols_estimator" title="Permalink to this definition"></a></dt>
<dd><p>Fits a linear model and stats using optimal least squares.</p>
<blockquote>
<div><p>For group g, the model for the i^th observation is of the form:</p>
<blockquote>
<div><p>y_i = x_i^Teta + ep_i,</p>
</div></blockquote>
</div></blockquote>
<p>where x_i are predictor variables of dimension P, and ep_i is noise with a fixed variance.</p>
<p>This function is based on chapter 4 of Greene, Econometric Analysis.</p>
<dl>
<dt>Args:</dt><dd><p>y: 1-d array of the predicted variable.  Of length n_smps.</p>
<p>x: Variables to predict from.  Of shape n_smps*d_x.</p>
<p>rcond: The value of rcond to provide to the least squares fitting.  See np.linalg.lstsq.</p>
</dd>
<dt>Returns:</dt><dd><p>beta: The estimate of beta</p>
<p>acm: The asymptotic covariance matrix for beta.</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: If the number of samples does not exceed the number of x variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="janelia_core.stats.regression.visualize_coefficient_stats">
<code class="sig-prename descclassname">janelia_core.stats.regression.</code><code class="sig-name descname">visualize_coefficient_stats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">var_strs</span><span class="p">:</span> <span class="n">Sequence</span></em>, <em class="sig-param"><span class="n">theta</span><span class="p">:</span> <span class="n">numpy.ndarray</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">c_ints</span><span class="p">:</span> <span class="n">numpy.ndarray</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">var_clrs</span><span class="p">:</span> <span class="n">numpy.ndarray</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sig</span><span class="p">:</span> <span class="n">numpy.ndarray</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">er_bar_pts</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></span> <span class="o">=</span> <span class="default_value">2</span></em>, <em class="sig-param"><span class="n">theta_size</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">sig_size</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">sig_y_vl</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_axis_rot</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></span> <span class="o">=</span> <span class="default_value">- 75</span></em>, <em class="sig-param"><span class="n">ax</span><span class="p">:</span> <span class="n">matplotlib.pyplot.axes</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot_zero_line</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; matplotlib.pyplot.axes<a class="reference internal" href="../../../../_modules/janelia_core/stats/regression.html#visualize_coefficient_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#janelia_core.stats.regression.visualize_coefficient_stats" title="Permalink to this definition"></a></dt>
<dd><p>For visualizing estimated coefficients with confidence intervals.</p>
<dl>
<dt>Args:</dt><dd><p>var_strs: Strings giving the name of each coefficient</p>
<p>theta: Point estimate for each coefficient, order corresponds to var_strs.  If None, point estimates will
not be plotted.</p>
<p>c_ints: c_ints[i,:] is the lower (left column) and upper (right column) limits on the confidence interval
for the coefficient in var_strs[i].  If None, confidencce intervals will not be plotted.</p>
<p>var_clrs: var_clrs[i,:] is the color to use for plotting the coefficient for var_strs[i].  If None, black
will be used for all plotting.</p>
<p>sig: sig[i] is True if the coefficient for var_strs[i] is significant. Significant values will have a
star plotted to indicate they are significant.</p>
<p>theta_size: The size of the marker to use when plotting point estimages of coefficients.</p>
<p>er_bar_pts: The width of error bars to plot for confidence intervals.</p>
<p>sig_size: The size of the marker to use when denoting which coefficients are significanly different 0.</p>
<p>sig_y_vl: If not None, this is the y-value used for showing significant stars.</p>
<p>plot_zero_line: True if a line indicating 0 should be plotted</p>
<p>x_axis_rot: Rotation in degrees of x-axis labels.</p>
<p>ax: Axes to plot into. If None, a new figure with axes will be created.</p>
</dd>
<dt>Returns:</dt><dd><p>as: The axes the plot was generated in.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, William Bishop.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>